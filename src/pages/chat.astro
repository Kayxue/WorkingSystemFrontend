---
import Layout from '../layouts/Layout.astro';
import ChatPage from '../components/ChatPage.solid.tsx';

const userData = Astro.locals?.authData?.user;
const isLoggedIn = Astro.locals?.authData?.loggedIn || false;

if (!isLoggedIn || !userData) {
  return Astro.redirect('/redirect-login');
}
---

<Layout title="Chats">
  <main class="chat-page">
    <div class="chat-container">
      <ChatPage 
        client:only 
        employerId={userData.employerId}
        workerId={userData.workerId}
        role={userData.role}
        profilePhotoUrl={userData.employerPhoto?.url || null}
      />
    </div>
  </main>
</Layout>

<style>
  .chat-page {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    height: calc(100vh - var(--navbar-height));
    padding-top: 72px;
    width: 100%;
  }

  .chat-container {
    background-color: #e5e7eb;
    border-radius: 8px;
    width: 100%;
  }
</style>